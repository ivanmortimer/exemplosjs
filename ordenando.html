<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ordenando Valores</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
    <script src="ordenando.js"></script>
</head>
<body>
    <div class="container-sm m-sm-3">
        <h1>Ordenendo Valores</h1>
        <div class="mb-sm-3 mt-sm-3">
            <label for="valor" class="form-label">Valor</label>
            <input class="form-control" type="number" step="1" id="valor" onkeypress="check_enter(event)">
            <button class="btn btn-primary mt-sm-2" onclick="add()">Adicionar</button>
        </div>
        <hr>
        <div class="mb-sm-3">
            <select class="form-select" id="selecao_de_algoritmo">
                <option selected>Bubble Sort</option>
                <option>Selection Sort</option>
                <option>Quick Sort</option>
            </select>
            <button class="btn btn-primary mt-sm-2" onclick="ordenar()">Ordenar</button>
            <button class="btn btn-primary mt-sm-2" onclick="misturar()">Misturar</button>
        </div>
        <hr>
        <div>
            <ul id="valores"></ul>
        </div>
    </div>
    <script>
        // Ao recarregar a página, resetar a seleção para o primeiro valor
        window.addEventListener('load', function() {
            const select_element = document.getElementById('selecao_de_algoritmo');
            select_element.selectedIndex = 0; // Seleciona o primeiro índice (Opção 1)
        });

        // Vetor JavaScript que irá guardar os valores obtidos a partir do mapeamento e filtragem dos
        // valores contidos nos elementos da lista <ul id="valores">
        var vetor_de_valores;

        /*
        Função que adiciona à lista <ul id="valores"> elemento de lista <li> cujo nó de texto filho 
        correspende à string representando o número que foi passada como valor ao campo <input id="valor">,
        e acrecenta esse número ao vetor atribuído à variável 'vetor_de_valores'. 
        */
        function add() {
            // Variável que armazena o elemento HTML <input id="valor">
            const input = document.getElementById("valor");

            // Variável que armazena a string que corresponde ao valor inserido no campo <input id="valor">
            let valor_entrada = document.getElementById("valor").value;

            // Variável que armazena o número correspondente à string armazenada na variável valor_entrada
            let numero_entrada = eval(valor_entrada);

            // Limpa o campo de input após o usuário clicar o botão 'Adicionar'
            input.value = '';

            // Condicional que verifica se houve não houve tentativa de adicionar um elemento vazio à lista
            // e se o elemento prestes a ser adicionado é um número inteiro
            if (valor_entrada != '' && Number.isInteger(numero_entrada)) {

                // Seleciona a lista pelo ID
                let lista = document.getElementById("valores");

                // Cria um elemento (i.e., um nó) HTML <li>
                let node = document.createElement("li");

                // Torna esse elemento <li> um filho da lista <ul id="valores">.
                lista.appendChild(node);

                // Cria um nó de text
                let texto = document.createTextNode(valor_entrada);

                // Torna o nó de texto criado acima um filho do elemento <li> criado anterirmente.
                node.appendChild(texto);
                
                // Obtém todos os itens (<li>) da lista
                let vetor_itens_lista = lista.children;

                // Mapeia o conteúdo de texto de cada item, filtra os itens vazios e armazena em um array
                vetor_de_valores = Array.from(vetor_itens_lista)
                    .map(item => item.textContent.trim()) // Extrai e remove espaços em branco
                    .filter(valor => valor !== '') // Filtra valores vazios
                    .map(valor => eval(valor)); // Transforma as strings em números.
            }           
        }


        /*
        Função para capturar o evento "Enter" no input
        */
        function check_enter(event) {
            if (event.key === "Enter") { // Verifica se a tecla pressionada foi "Enter"
                add(); // Chama a função add()
            }
        }

        /*
        Função que coloca em ordem crescente os números contidos no array 'vetor_de_valores', através de 
        um dos três possíveis algoritmos selecionados pelo usuário ('bubble_sort', 'selection_sort' ou 
        'quick_sort'); em seguida mapeia cada desses números transformando-os em uma string flanqueafa pelas 
        tags <li> e </li>; depois concatena esses elementos em uma única string através da função 'reduce';
        e por fim introduz essa string dentro do elemento <ul ="valores">, como seu conteúdo, através do 
        método 'innerHTML', que interpreta tal string como conteúdo HTML.
        */
        function ordenar() {

            let algoritmo_selecionado = eval(document.getElementById("selecao_de_algoritmo").selectedIndex);
            let retorno_do_algoritmo =
                (algoritmo_selecionado == 0) ? bubble_sort(vetor_de_valores) :
                (algoritmo_selecionado == 1) ? selection_sort(vetor_de_valores) :
                quick_sort(vetor_de_valores);
            
            if (retorno_do_algoritmo) {

                // Transforma cada valor em um elemento <li> usando map e junta tudo com reduce
                const novo_conteudo_HTML = vetor_de_valores
                    .map(valor => `<li>${valor}</li>`) // Mapeia cada valor para <li>
                    .reduce((acc, item) => acc + item, ""); // Concatena os itens em uma única string

                // Seleciona a lista <ul id="valores"> pelo ID
                const lista = document.getElementById("valores");

                // Substitui o conteúdo da lista com os novos <li>
                lista.innerHTML = novo_conteudo_HTML;
            }
        }


        /*
        Função que embaralha os números contidos no array 'vetor_de_valores', através do algoritmo shuffle; 
        e em seguida executa os mesmos passos da função 'ordenar' declarada acima para incluir esses
        elementos desse vetor na forma de conteúdo HTML (elementos <li>) dentro do elemento HTML cuja tag 
        inicial é <ul id="valores">.
        */
        function misturar() {
            let algoritmo_selecionado = eval(document.getElementById("selecao_de_algoritmo").selectedIndex);
            let retorno_do_algoritmo = shuffle(vetor_de_valores, vetor_de_valores.length);
            
            if (retorno_do_algoritmo) {

                // Transforma cada valor em um elemento <li> usando map e junta tudo com reduce
                const novo_conteudo_HTML = vetor_de_valores
                    .map(valor => `<li>${valor}</li>`) // Mapeia cada valor para <li>
                    .reduce((acc, item) => acc + item, ""); // Concatena os itens em uma única string

                // Seleciona a lista <ul id="valores"> pelo ID
                const lista = document.getElementById("valores");

                // Substitui o conteúdo da lista com os novos <li>
                lista.innerHTML = novo_conteudo_HTML;
            }
        }
    </script>
</body>
</html>